import{_ as w,r as v,c as k,w as N,o as d,a as m,b as s,F as A,d as S,e as G,v as F,f as M,g as j,n as R,t as g,h as x,u as T,i as q,j as H,k as D,l as J,m as V,p as P}from"./index-Be26Xvvf.js";const L={name:"CodeField",props:{length:{type:Number,required:!0},modelValue:{type:String,required:!0}},setup(a,{emit:t}){const n=v(Array(a.length).fill("")),e=v([]),c=k(()=>Array.from({length:a.length},(u,r)=>r+1)),i=(u,r)=>{u.target.value&&r<a.length&&R(()=>{e.value[r].focus()}),o()},o=()=>{t("update:modelValue",n.value.join(""))},l=()=>{t("validate",n.value.join(""))};return N(()=>a.modelValue,u=>{n.value=u.split("").slice(0,a.length)}),{code:n,inputArray:c,updateModel:o,validateCode:l,handleInput:i,inputs:e}}},O={class:"code-field"},U={class:"guess-container"},E=["onUpdate:modelValue","onInput"];function K(a,t,n,e,c,i){return d(),m("div",O,[s("div",U,[(d(!0),m(A,null,S(e.inputArray,o=>(d(),m("div",{key:o},[G(s("input",{ref_for:!0,ref:"inputs",type:"text","onUpdate:modelValue":l=>e.code[o-1]=l,maxlength:"1",onInput:l=>e.handleInput(l,o),onKeydown:t[0]||(t[0]=M(j((...l)=>e.validateCode&&e.validateCode(...l),["prevent"]),["enter"]))},null,40,E),[[F,e.code[o-1]]])]))),128))]),s("button",{onClick:t[1]||(t[1]=(...o)=>e.validateCode&&e.validateCode(...o))},"Valider")])}const z=w(L,[["render",K],["__scopeId","data-v-d4ce4471"]]),$={name:"Popup",props:{show:{type:Boolean,required:!0},message:{type:String,required:!0}},setup(a,{emit:t}){const n=T();return{closePopup:()=>{t("close")},goHome:()=>{n.push("/")}}}},Q={key:0,class:"overlay"},W={class:"popup"};function X(a,t,n,e,c,i){return n.show?(d(),m("div",Q,[s("div",W,[s("h2",null,g(n.message),1),s("button",{onClick:t[0]||(t[0]=(...o)=>e.closePopup&&e.closePopup(...o))},"Fermer"),s("button",{onClick:t[1]||(t[1]=(...o)=>e.goHome&&e.goHome(...o))},"Retour à l'accueil")])])):x("",!0)}const Y=w($,[["render",X],["__scopeId","data-v-2204f931"]]),Z="/deploy/assets/gigamind2-CitwT1-O.png",ee={components:{CodeField:z,Popup:Y},setup(){const{code:a,attempts:t,state:n,generateCode:e,validateAttempt:c}=q(),i=V("pseudo"),o=V("gameSettings"),l=v(""),u=o.lives,r=v(!1),f=v(""),C=k(()=>u-t.value.length),h=p=>{document.getElementById("gigamind-dialog").innerText=p};return H(()=>{const p=i.pseudo||"joueur";h(`Bonjour ${p}, sauras-tu me battre ?`)}),{pseudo:i,gameSettings:o,code:a,attempts:t,state:n,userAttempt:l,submitGuess:p=>{if(p.length===o.numbers){const{wellPlaced:_,misplaced:I}=c(p);l.value="";let y="";switch(_){case o.numbers:h(`Tu m'as battu, ${i.pseudo}. Je reviendrai !`),f.value="Bravo, vous êtes le nouveau Gigamind !",r.value=!0,y="Succès";break;default:h(`Tu en as placé ${_}, tu me déçois, ${i.pseudo} !`),y="Échec";break}if(_===o.numbers||C.value===0){const B={pseudo:i.pseudo,code:a.value,result:y,lastAttempt:p,wellPlaced:_,misplaced:I,date:new Date().toLocaleString()},b=JSON.parse(localStorage.getItem("gameResults"))||[];b.push(B),localStorage.setItem("gameResults",JSON.stringify(b))}n.value==="perdue"&&(f.value="Le Gigamind a gagné ! Code secret: "+a.value,r.value=!0)}else alert("Veuillez entrer un code de "+o.numbers+" chiffres.")},remainingAttempts:C,showPopup:r,popupMessage:f,closePopup:()=>{r.value=!1}}}},te={class:"container"},oe={class:"game"},se={class:"guess"},ne={class:"history"};function ae(a,t,n,e,c,i){const o=P("CodeField"),l=P("Popup");return d(),m("div",te,[t[4]||(t[4]=s("div",{class:"gigamind"},[s("img",{src:Z,alt:"Gigamind",srcset:""}),s("p",{id:"gigamind-dialog"},"(Nothing to say)")],-1)),s("div",oe,[s("div",se,[s("h2",null,"Votre proposition - Nombre d'essais restants : "+g(e.remainingAttempts),1),D(o,{length:e.gameSettings.numbers,modelValue:e.userAttempt,"onUpdate:modelValue":t[0]||(t[0]=u=>e.userAttempt=u),onValidate:e.submitGuess},null,8,["length","modelValue","onValidate"]),t[1]||(t[1]=s("div",null,null,-1))]),s("div",ne,[t[2]||(t[2]=s("h2",null,"Historique",-1)),s("ul",null,[(d(!0),m(A,null,S(e.attempts,(u,r)=>(d(),m("li",{key:r},g(u.attempt)+" - Bien placés: "+g(u.wellPlaced)+", Mal placés: "+g(u.misplaced),1))),128))]),t[3]||(t[3]=s("div",null,null,-1))])]),e.showPopup?(d(),J(l,{key:0,show:e.showPopup,message:e.popupMessage,onClose:e.closePopup},null,8,["show","message","onClose"])):x("",!0)])}const ie=w(ee,[["render",ae],["__scopeId","data-v-8d679859"]]);export{ie as default};
